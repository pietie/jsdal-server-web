<router-outlet #topEl></router-outlet>

<mat-card>
    <mat-card-content>
        <mat-form-field>
            <input #errRef matInput type="text" placeholder="Error ref#" autocomplete="off" />
        </mat-form-field>
    </mat-card-content>
    <mat-card-actions>
        <button [disabled]="isLoadingExceptionList" #lookupButton mat-button color="primary" (click)="lookupError(errRef.value); topEl.scrollIntoView();">LOOKUP</button>
    </mat-card-actions>
</mat-card>


<mat-card>
    <mat-card-title>Recent exceptions</mat-card-title>
    <mat-card-content>

        <p>
            (Total # of exceptions in memory: {{ totalExceptionCnt }}) <button (click)="clearAll()" mat-button
                color="warn">CLEAR ALL</button>
        </p>

        <div *ngIf="recentExceptions">
            <div>
                <button mat-button color="primary" (click)="fetchRecentExceptions()" [disabled]="isLoadingExceptionList">REFRESH</button>

            </div>
            <br/><br/>
            <div>
                <mat-form-field>
                    <mat-label>Top (n)</mat-label>
                    <mat-select [(ngModel)]="topN" (selectionChange)="fetchRecentExceptions()" [disabled]="isLoadingExceptionList">
                        <mat-option [value]="10">10</mat-option>
                        <mat-option [value]="50">50</mat-option>
                        <mat-option [value]="100">100</mat-option>
                        <mat-option [value]="500">500</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>

            <p *ngIf="recentExceptions.length == 0 && !isLoadingExceptionList">
                No recent exceptions found.
            </p>

            <mat-spinner diameter="20" *ngIf="isLoadingExceptionList"></mat-spinner>

            <div class="exception-item" *ngFor="let ex of recentExceptions">
                <span [title]="ex.created | date: 'dd MMM yyyy'">{{ ex.created | date: 'HH:mm:ss' }}</span>
                <div style="width:90px;display:inline-block;">
                    <button [disabled]="isLoadingExceptionList" style="font-family: Courier;font-weight: 800;"
                        (click)="errRef.value=ex.id;lookupError(ex.id); topEl.scrollIntoView();" mat-button color="primary">{{ ex.id }}</button>
                </div>
                <div class="app-title" *ngIf="ex.appTitle" [title]="ex.appTitle">{{ ex.appTitle }} </div>
                <div class="msg" *ngIf="ex" [innerHTML]="formatMessage(ex.message)">

                </div>

            </div>

        </div>

    </mat-card-content>
</mat-card>